<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>akvo.notifications.events documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Akvo-notifications 0.3.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>akvo</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>notifications</span></div></div></li><li class="depth-3 branch"><a href="akvo.notifications.drafts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>drafts</span></div></a></li><li class="depth-3 branch current"><a href="akvo.notifications.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-3 branch"><a href="akvo.notifications.main.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>main</span></div></a></li><li class="depth-3 branch"><a href="akvo.notifications.store-mem.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store-mem</span></div></a></li><li class="depth-3 branch"><a href="akvo.notifications.systems.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>systems</span></div></a></li><li class="depth-3 branch"><a href="akvo.notifications.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-3"><a href="akvo.notifications.web.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="akvo.notifications.events.html#var--.3EEvents"><div class="inner"><span>-&gt;Events</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-base-graph"><div class="inner"><span>base-graph</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-BaseEvent"><div class="inner"><span>BaseEvent</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-BaseServiceEvent"><div class="inner"><span>BaseServiceEvent</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-deep-merge"><div class="inner"><span>deep-merge</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-end-subscription"><div class="inner"><span>end-subscription</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-end-subscription-graph"><div class="inner"><span>end-subscription-graph</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-events"><div class="inner"><span>events</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-get-event"><div class="inner"><span>get-event</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-get-event-id"><div class="inner"><span>get-event-id</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-get-or-create-user"><div class="inner"><span>get-or-create-user</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-graphs"><div class="inner"><span>graphs</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-handle-event"><div class="inner"><span>handle-event</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-map-.3EEvents"><div class="inner"><span>map-&gt;Events</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-parse-int"><div class="inner"><span>parse-int</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-parse-message"><div class="inner"><span>parse-message</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-project-donation"><div class="inner"><span>project-donation</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-project-donation-graph"><div class="inner"><span>project-donation-graph</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-ProjectDonation"><div class="inner"><span>ProjectDonation</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-schemas"><div class="inner"><span>schemas</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-start-subscription"><div class="inner"><span>start-subscription</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-start-subscription-graph"><div class="inner"><span>start-subscription-graph</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-Subscriptions"><div class="inner"><span>Subscriptions</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-user-notified"><div class="inner"><span>user-notified</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-user-notified-graph"><div class="inner"><span>user-notified-graph</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-UserNotified"><div class="inner"><span>UserNotified</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-valid-service-name.3F"><div class="inner"><span>valid-service-name?</span></div></a></li><li class="depth-1"><a href="akvo.notifications.events.html#var-validate-event"><div class="inner"><span>validate-event</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">akvo.notifications.events</h2><div class="doc"><pre class="plaintext">Events.. &apos;suid&apos; = &apos;service user id&apos; e.i. external service user id
</pre></div><div class="public anchor" id="var--.3EEvents"><h3>-&gt;Events</h3><div class="usage"><code>(-&gt;Events queue uri connection channel)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class akvo.notifications.events.Events.
</pre></div></div><div class="public anchor" id="var-base-graph"><h3>base-graph</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Base graph that will parse message with the help of Content-Type,
then get the id and grab the event from configured data store. When we
assoc on the chain should end in a final keyword element.</pre></div></div><div class="public anchor" id="var-BaseEvent"><h3>BaseEvent</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Basic event schema
</pre></div></div><div class="public anchor" id="var-BaseServiceEvent"><h3>BaseServiceEvent</h3><div class="usage"></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-deep-merge"><h3>deep-merge</h3><div class="usage"><code>(deep-merge &amp; vals)</code></div><div class="doc"><pre class="plaintext">Recursively merges maps. If keys are not maps, the last value wins.
</pre></div></div><div class="public anchor" id="var-end-subscription"><h3>end-subscription</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-end-subscription-graph"><h3>end-subscription-graph</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Uses the schemas var to dig up and validate the event based on event type.
</pre></div></div><div class="public anchor" id="var-events"><h3>events</h3><div class="usage"><code>(events host port user password vhost)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-get-event"><h3>get-event</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-get-event-id"><h3>get-event-id</h3><div class="usage"></div><div class="doc"><pre class="plaintext">First calls parse-message that will parse the message based on
content type. Then pulls out the :id.</pre></div></div><div class="public anchor" id="var-get-or-create-user"><h3>get-or-create-user</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-graphs"><h3>graphs</h3><div class="usage"></div><div class="doc"><pre class="plaintext">All the graphs ready to be computed
</pre></div></div><div class="public anchor" id="var-handle-event"><h3>handle-event</h3><div class="usage"><code>(handle-event store meta message)</code></div><div class="doc"><pre class="plaintext">Init a graph computation to handle message of different kinds of
types.</pre></div></div><div class="public anchor" id="var-map-.3EEvents"><h3>map-&gt;Events</h3><div class="usage"><code>(map-&gt;Events m__5869__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class akvo.notifications.events.Events, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-parse-int"><h3>parse-int</h3><div class="usage"><code>(parse-int string)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-parse-message"><h3>parse-message</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Parses a message in JSON/ EDN and return a Clojure data structure.
</pre></div></div><div class="public anchor" id="var-project-donation"><h3>project-donation</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-project-donation-graph"><h3>project-donation-graph</h3><div class="usage"></div><div class="doc"><pre class="plaintext">..
</pre></div></div><div class="public anchor" id="var-ProjectDonation"><h3>ProjectDonation</h3><div class="usage"></div><div class="doc"><pre class="plaintext">...
</pre></div></div><div class="public anchor" id="var-schemas"><h3>schemas</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A map of all different schemas indexed by the event (keywordized) types
</pre></div></div><div class="public anchor" id="var-start-subscription"><h3>start-subscription</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-start-subscription-graph"><h3>start-subscription-graph</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Uses the schemas var to dig up and validate the event based on event type.
</pre></div></div><div class="public anchor" id="var-Subscriptions"><h3>Subscriptions</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Start subscription schema
</pre></div></div><div class="public anchor" id="var-user-notified"><h3>user-notified</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-user-notified-graph"><h3>user-notified-graph</h3><div class="usage"></div><div class="doc"><pre class="plaintext">..
</pre></div></div><div class="public anchor" id="var-UserNotified"><h3>UserNotified</h3><div class="usage"></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-valid-service-name.3F"><h3>valid-service-name?</h3><div class="usage"><code>(valid-service-name? x)</code></div><div class="doc"><pre class="plaintext">Verifies that the service name starts with akvo-&lt;identifier&gt; where
identifier have to be at least one character long</pre></div></div><div class="public anchor" id="var-validate-event"><h3>validate-event</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div></div></body></html>